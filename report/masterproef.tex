\documentclass[master=elt,masteroption=eg,english]{kulemt}
\setup{% Verwijder de "%" op de volgende lijn bij UTF-8 karakterencodering
  %inputenc=utf8,
  title={Learning comfort objective from lane change demonstrations for optimal control},
  author={Stijn Staring},
  promotor={Prof.\,dr.\,ir.\ Jan Swevers},
  assessor={Prof.\,dr.\,ir.\ Bert Pluymers\and Prof.\,dr.\,ir.\ Herman Bruyninckx},
  assistant={Dr.\,ir.\ Son Tong}}
% DENK ERAAN OM DE MASTER OPTIE AAN TE PASSEN OP HET EINDE!
% Verwijder de "%" op de volgende lijn als je de kaft wil afdrukken
%\setup{coverpageonly}
% Verwijder de "%" op de volgende lijn als je enkel de eerste pagina's wil
% afdrukken en de rest bv. via Word aanmaken.
%\setup{frontpagesonly}

% Kies de fonts voor de gewone tekst, bv. Latin Modern
\setup{font=lm}

% Hier kun je dan nog andere pakketten laden of eigen definities voorzien

% Tenslotte wordt hyperref gebruikt voor pdf bestanden.
% Dit mag verwijderd worden voor de af te drukken versie.

% Packages:
%%%%%%%
\usepackage[pdfusetitle,colorlinks,plainpages=false]{hyperref}
\usepackage{bm}
\setlength\parindent{0pt}
\usepackage{graphicx}
\graphicspath{{figures/}}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{wrapfig}
\usepackage{physics}
\usepackage{booktabs}
\usepackage[ruled,vlined]{algorithm2e}
\usepackage{amsthm}
\usepackage{caption}
\usepackage{subcaption}
%\usepackage[demo]{graphicx}

%%%%%%%
% Om wat tekst te genereren wordt hier het lipsum pakket gebruikt.
% Bij een echte masterproef heb je dit natuurlijk nooit nodig!
\IfFileExists{lipsum.sty}%
 {\usepackage{lipsum}\setlipsumdefault{11-13}}%
 {\newcommand{\lipsum}[1][11-13]{\par Hier komt wat tekst: lipsum ##1.\par}}
%%%%%%%

%\includeonly{chap-n}
\begin{document}
%	Do not forget to change the 'elt' study to mechanical engineering.

\begin{preface}
	I would like to thank my family in the first place. During the history of my studies they always have been my biggest fans and I want to show my gratitude for the opportunities they have given me. I also want to thank my promoter Professor Swevers from the KU Leuven and Dr. Tong my mentor from Siemens for the professional discussions and tips they have given me in order to improve my results. I also want to thank Flavia Acerbo, an employee at Siemens, who answered my questions on several occasions. Finally I want to thank my aunt and sister for proofreading this thesis.

\end{preface}

\tableofcontents*

\begin{abstract}
%  The \texttt{abstract} environment contains a more extensive overview of
%  the work. But it should be limited to one page.

The human driver transforms from being an active traffic participant into a passive agent due to the developments in autonomous driving. Consequently the human involvement becomes limited by perceiving and rating decisions taken by the vehicle. In order to enhance user acceptance and to increase competitiveness, it is important that a notion of driver specific comfort is taken into account. \\

Therefore the objective of this research is to develop an algorithm based on inverse reinforcement learning which is able to learn driver specific experiences of comfort during a lane change, captured in weights of an objective function. Learning is done by looking at observations performed by the human driver because the learned objective function is an approximation of the one used when the driver generates comfortable paths. Comfort features, which are integrated kinematic vehicle signals in a formulation so that they determine a notion of comfort, are used in order to quantify similarity between observed and learned vehicle paths. The contribution of this thesis is to implement the theoretical idea of feature based learning with practical relevant vehicle models e.g. a $15$ degrees of freedom Amesim model. When the comfort objective is identified, it can be embedded in a path planning formulation for autonomous driving.\\

In order to validate the developed algorithms for learning driver specific weights, data is generated with a known objective function which is tried to find back. Implementations are attained that make use of a non-linear bicycle model and a more complex $15$ degrees of freedom Amesim model. Learning is done making use of gradient descent, wherefore an alternative method is proposed based on an optimization of the step size.\\

Results were retrieved that show that the lateral weights, that determine a lane change, were accurately learned. Due to a good match between learned and observed feature values, the observed kinematic vehicle signals were adequately learned. This research was performed with the help of Siemens Digital Industries Software. \\
\end{abstract}

\begin{abstract*}
De menselijke bestuurder transformeert van een actieve naar een passieve deelnemer van het verkeer door ontwikkelingen die worden verwezenlijkt in onderzoek naar zelfrijdende auto's.  Dit heeft als consequentie dat de rol van de menselijke bestuurder beperkt wordt tot het waarnemen en beoordelen van handelingen uitgevoerd door een zelfrijdend voertuig.  Om consumentenacceptatie te bevorderen en de competitiviteit van het product te verhogen, is het belangrijk dat bestuurderspecifiekebeoordeling van comfort gemodelleerd kan worden.\\

Hierdoor is onderzoek uitgevoerd met als doel een algoritme te ontwikkelen gebaseerd op 'inverse reinforcement learning' dat in staat is om specifieke comfort bevindingen bevat in een objectief functie te leren, voor een rijbaanwisseling maneuver. Hiervoor wordt er gekeken naar observaties van het maneuver uitgevoerd door een menselijke bestuurder omdat het geleerde objectief degene benadert die werkelijk gebruikt wordt door de bestuurder om een comfortabel maneuver uit te voeren.
Comfort features, wat ge{\"i}ntegreerde voertuigsignalen zijn in een formulering zodat ze een notie van comfort bevatten, worden gebruikt om de overeenkomst uit te drukken tussen het geobserveerde en geleerde voertuigpad. De bijdrage van deze thesis is het theoretische idee van feature gebaseerd leren te gebruiken met praktisch relevant voertuigmodellen zoals het 15 vrijheidsgraden bevattende Amesim model. Wanneer het comfort objectief is ge{\"i}dentificeerd, kan het gebruikt worden om paden te plannen voor een zelfrijdend voertuig.\\

Om de ontwikkelde algoritmes voor het leren van bestuurder specifieke wegingsfactoren te valideren, is data gegenereerd met een op voorhand gekend objectief dat zal geprobeerd teruggevonden te worden. Implementaties zijn verwezenlijkt die gebruik maken van een 'non-linear bicycle model' en het meer complexe 15 vrijheidsgraden bevattende Amesim model. Tijdens het leerproces is de gradi{\"e}nt afdaling methode gebruikt waarvoor een alternatief wordt voorgesteld dat gebaseerd op een optimalisatie van de stap grootte.\\ 

Resultaten werden bekomen die tonen dat de laterale wegingsfactoren die bepalen hoe een rijbaanwisseling wordt uitgevoerd, accuraat geleerd kunnen worden. Door een goede match tussen de geleerde en geobserveerde feature waardes werden de geobserveerde voertuigsignalen accuraat geleerd. Dit onderzoek is uitgevoerd met de hulp van Siemens Digital Industries Software.  


  

%  environment wordt een al dan niet uitgebreide
%  Nederlandse samenvatting van het werk gegeven.
%  Wanneer de tekst voor een Nederlandstalige master in het Engels wordt
%  geschreven, wordt hier normaal een uitgebreide samenvatting verwacht,
%  bijvoorbeeld een tiental bladzijden.  
\end{abstract*}

% Een lijst van figuren en tabellen is optioneel
%\listoffigures
%\listoftables
% Bij een beperkt aantal figuren en tabellen gebruik je liever het volgende:
\listoffiguresandtables
% De lijst van symbolen is eveneens optioneel.
% Deze lijst moet wel manueel aangemaakt worden, bv. als volgt:
\chapter{List of Abbreviations and Symbols}
\section*{Abbreviations}
\begin{flushleft}
  \renewcommand{\arraystretch}{1.1}
  \begin{tabularx}{\textwidth}{@{}p{12mm}X@{}}
    MS   & Multiple shooting  \\
    SS   & Single shooting  \\
    Gs   & Gsteeringfactor  \\
    OCP  & Optimal control problem\\
    MPC  & Model predictive control\\
    ODE  & Ordinary differential equation\\
    ND	 & Number of datasets\\
    dof  & Degrees of freedom
  \end{tabularx}
\end{flushleft}
\section*{Symbols}
\begin{flushleft}
  \renewcommand{\arraystretch}{1.1}
  \begin{tabularx}{\textwidth}{@{}p{12mm}X@{}}
  		& Vectors are printed in bold. \\
    $N$    &  The number of control actions performed during optimization Eq. (\ref{opt:basic_opti_w}). \\
    $N_{MPC}$ & Amount of control points in the control horizon of Eq. (\ref{opt:tracking}).\\
    $m$ & Amount of observed lane changes.\\
    $Z$ & Amount of features.\\
    $\bm{r}$ & The 2D path followed during a lane change maneuver.\\
    $\bm{F(\bm{r})}$ & Feature vector $\in \mathbb{R}^{Z\times 1}$ with on its entries the different feature values for learned path $\bm{r}$.\\
    $\bm{\tilde{F}(\bm{r})}$ & Observed feature vector $\in \mathbb{R}^{Z\times 1}$ with on its entries the different feature values for the observed path $\bm{r}$.\\
    $\bm{F}_{diff}$ & The difference between the observed and expected feature vector: $\tilde{F}(\bm{r}) - F(\bm{r})$.\\
    $V_{0}$ & Longitudinal speed at the start of the lane change.\\
    $V_{des}$ & Desired longitudinal speed during a lane change. Taken equal to $V_{0}$ during this thesis.\\
   $L$   & Desired lateral distance travelled at the end of the lane change.
    
    
    

    
	\end{tabularx}
\end{flushleft}

\begin{flushleft}
	\renewcommand{\arraystretch}{1.1}
	\begin{tabularx}{\textwidth}{@{}p{12mm}X@{}}
		$\bm{\theta}$ & Weights that are learned in the objective function Eq. (\ref{eq:obj}).\\
		$\bm{f}_{obs}$ & Feature vector calculated from observed lane change path according to Eq. (\ref{s:obj}).\\
		$\bm{f}_{learned}$ & Feature vector as calculated according to Eq. (\ref{s:obj}) from the lane change path following out of solving Eq. (\ref{opt:basic_opti_w}).\\
		$\bm{f}_{rel}$ & Relative feature vector defined as the element wise division of the learned feature vector by the observed one e.g. $\frac{\bm{f}_{learned}}{\bm{f}_{obs}}$.\\
		$t_r$ & Amount of throttle given.\\
		$\delta$ & Angle of the front wheel of the bicycle model.\\
		$\delta_{s} $ & The steer wheel angle, related to $\delta$ by $G_s$ according to $\delta_s = Gs \cdot\delta$.  \\
		$\Delta u$ & Update value used in the RPROP algorithm in section \ref{s:RPROP}.
	\end{tabularx}
\end{flushleft}

% Nu begint de eigenlijke tekst
\mainmatter

\include{intro}
\include{chap-1}
\include{chap-2}
\include{chap-3}
\include{chap-4}
\include{chap-5}
%\include{chap-6}
\include{conclusion}

% Indien er bijlagen zijn:
\appendixpage*          % indien gewenst
\appendix
\include{app-A}
\include{app-B}
\include{app-C}
\include{app-D}
\include{app-E}

\backmatter
% Na de bijlagen plaatst men nog de bibliografie.
% Je kan de  standaard "abbrv" bibliografiestijl vervangen door een andere.
\bibliographystyle{abbrv}
\bibliography{Thesis_ref}
%\bibliography{references}

\end{document}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 
